<!--

    Copyright (C) 2015 The Gravitee team (http://gravitee.io)

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

            http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->


<div class="add-integration">
  <div class="header">
    <h1 class="title">Add {{serviceName}} integration</h1>
    <p *ngIf="this.provider === Providers.aws " class="overview">
      Connect to {{serviceName}} for API management and data integration. Customize API proxies with Gravitee Gateway or
      expose data sources directly.
    </p>
    <p *ngIf="this.provider === Providers.solace" class="overview">
      Discover AsyncAPIs in Kafka and expose them with Gravitee. Use protocol translation or use Gravitee's Consumer
      Portal for direct client connection.
    </p>
  </div>


  <form class="form" [formGroup]="addIntegrationForm" (ngSubmit)="onSubmit(addIntegrationForm)">

    <div class="general">
      <h3 class="sub-title">General Information</h3>
      <div class="controlls">
        <mat-form-field class="control">
          <mat-label>Integration name</mat-label>
          <input formControlName="name" matInput type="text" />
          <mat-error *ngIf="false">Integration name is required.</mat-error>
        </mat-form-field>
        <mat-form-field class="control">
          <mat-label>Description of integration</mat-label>
          <textarea
            formControlName="description"
            matInput
            placeholder=""
            maxlength="250"
            #descriptionText
          ></textarea>
          <mat-hint class="description-hint" align="end">{{descriptionText.value.length}} / 250</mat-hint>
          <mat-error *ngIf="false">Description of integration is required.</mat-error>
        </mat-form-field>
      </div>
    </div>

    <div class="radio-group">
      <mat-radio-group aria-label="Select an option">
        <h3 class="title">Connection mode with {{serviceName}}</h3>

        <div class="radio-options">
          <div class="radio-option selected">
            <mat-radio-button value="1" checked>Connect with Gravitee control plane</mat-radio-button>
            <p class="info">
              Use this if your integration is accessible from the installation of your Gravitee control plane
            </p>

            <div formGroupName="configuration" class="controlls">
              <ng-container *ngFor="let input of configurationFields.inputs">
                <mat-form-field class="control">
                  <mat-label>{{input.label}}</mat-label>
                  <input [formControlName]="input.formControlName" matInput type="text"/>
                  <mat-error *ngIf="false">{{input.label}} is required.</mat-error>
                </mat-form-field>
              </ng-container>
            </div>
          </div>

          <div class="radio-option">
            <mat-radio-button disabled value="2">
              Connect with self-hosted agent
              <span class="badge gio-badge-primary">Coming soon</span>
            </mat-radio-button>
            <p class="info disabled">
              Use this if your integration is only accessible on your private network. You host and manage the
              credentials to the integration inside the agent
            </p>
          </div>
        </div>
      </mat-radio-group>
    </div>


    <div class="submit">
      <button mat-stroked-button class="submit-button" type="submit">
        {{!(addIntegrationService.isLoading$() | async) ? "Create integration" : "Creating integra..."}}
      </button>
      <button mat-stroked-button (click)="handleExit()">Exit without saving</button>
    </div>
  </form>
</div>
